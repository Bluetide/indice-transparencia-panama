{% extends 'base.html' %}
{% load staticfiles %}

{% block container %}

<section class="">
  <div class="container-fluid">
    <div class="row">
      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <p>√çndice de Transparencia de parlamentarios</p>
        
        <form action="" method="get" class="filter_form">
            <!--{{ filter.form.as_table }}-->
            <div class="form-group col-sm-4 col-md-3">
              es diputado ?
              {{ filter.form.is_deputy }}
            </div>
            <div class="form-group col-sm-4 col-md-3">
              circuito ?
              {{ filter.form.circuit }}
            </div>
            <div class="form-group col-sm-4 col-md-3">
              partido ?
              {{ filter.form.party }}
            </div>
            <div class="form-group col-sm-4 col-md-3">
              ordenar 
              {{ filter.form.ordering }}
            </div>
            <!--<button type="submit" class="btn btn-primary" id="filter_button">-->
            <!--  <span class="glyphicon glyphicon-search"></span> Search-->
            <!--</button>-->
        </form>
        
        <table class="table table-inverse">
          <thead>
            <tr>
              <th></th>
              <th>Nombre</th>
              <th>Partido</th>
              <th>Circuito</th>
              <th>Nota</th>
            </tr>
          </thead>
          <tbody>
        {% for person in filter.qs %}
           <tr>
             <td>{{ person.position_in_ranking }}</td>
           <td><a href="{{ person.get_absolute_url }}">
             <div class="col-md-1 px-0">
                  <img src="{% if person.image %}{{ person.image.url }}{% else %}{% static "images/person_icon.png" %}{% endif %}" class="img-fluid">
             </div>
              {{person.name }} </a></td>
           <td>{{ person.party }}</td>
           <td>{{ person.circuit }}</td>
           <td>{{ person.ranking_mark }}</td>
           </tr>
        {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>
{% endblock container %}

{% block extra_end_js %}
<script type="text/javascript" >
    $(document).ready(function() {
        $(".filter_form :input").each(
            function(index){
                var input = $(this);
                var id = input.attr('id')
                $("#"+id).addClass("filter_field")
                $("#"+id).on('change', function(event) {
                    event.preventDefault();
                    var input = $(this);
                    $(".filter_form")[0].submit();
                });
            }
        );
    });
</script>
{% endblock extra_end_js %}
