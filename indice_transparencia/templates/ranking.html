{% extends 'base.html' %}
{% load staticfiles %}
{% load bootstrap4 %}

{% block container %}

<section class="">
  <div class="container-fluid">
    <div class="row">
        <div class="col-12">
          <p>Índice de Transparencia de parlamentarios</p>
        </div>
        </div>
         <!-- Nati querida, pensé en dejarte una clase, esta ahora no tienen nada
              pero pensé que podrías querer ponerle alguna cosa como esta para que se vea ordenado.
              Esto hace que todos los labels se vean a la misma altura.
              -->
        <style type="text/css">
          
          .label_filter_ranking {
                min-height: 57px;
              }
        </style>
        <form action="" method="get" class="filter_form">
          <div class="row">    
            <div class="col-3">
             
              <div class="label_filter_ranking">
              {% bootstrap_label filter.form.is_deputy.label label_for='is_deputy' %}
              </div>
              {% bootstrap_field filter.form.is_deputy show_label=False %}
            </div>
            <div class="col-3">
              <div class="label_filter_ranking">
              {% bootstrap_label filter.form.circuit.label label_for='circuit' %}
              </div>
              {% bootstrap_field filter.form.circuit  show_label=False  %}
            </div>
            <div class="col-3">
              <div class="label_filter_ranking">
              {% bootstrap_label filter.form.party.label label_for='party' %}
              </div>
              {% bootstrap_field filter.form.party show_label=False  %}
            </div>
            <div class="col-3">
              <div class="label_filter_ranking">
              {% bootstrap_label filter.form.ordering.label label_for='ordering' %}
              </div>
              {% bootstrap_field filter.form.ordering show_label=False  %}
            </div>
            </div>
            <!--<button type="submit" class="btn btn-primary" id="filter_button">-->
            <!--  <span class="glyphicon glyphicon-search"></span> Search-->
            <!--</button>-->
            
        </form>
        <div class="col-12">
        
        <table class="table table-inverse">
          <thead>
            <tr>
              <th></th>
              <th>Nombre</th>
              <th>Partido</th>
              <th>Circuito</th>
              <th>Nota</th>
            </tr>
          </thead>
          <tbody>
        {% for person in filter.qs %}
           <tr>
             <td>{{ person.position_in_ranking }}</td>
           <td><a href="{{ person.get_absolute_url }}">
             <div class="col-md-1 px-0">
                  <img src="{% if person.image %}{{ person.image.url }}{% else %}{% static "images/person_icon.png" %}{% endif %}" class="img-fluid">
             </div>
              {{person.name }} </a></td>
           <td>{{ person.party }}</td>
           <td>{{ person.circuit }}</td>
           <td>{{ person.ranking_mark }}</td>
           </tr>
        {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>
{% endblock container %}

{% block extra_end_js %}
<script type="text/javascript" >
    $(document).ready(function() {
        $(".filter_form :input").each(
            function(index){
                var input = $(this);
                var id = input.attr('id')
                $("#"+id).addClass("filter_field")
                $("#"+id).on('change', function(event) {
                    event.preventDefault();
                    var input = $(this);
                    $(".filter_form")[0].submit();
                });
            }
        );
    });
</script>
{% endblock extra_end_js %}
